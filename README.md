# csv2

<pre>
【概要】
  デフォルトでは空白で整形されたテキスト形式の表に変換
    例) hoge,ahaha,ehehe
        4,20,8
        62,4,7
         ↓
        hoge ahaha ehehe
           4    20     8
          62     4     7
  他には‥‥
  1. HTML や TeX などの形式の表を CSV 形式のファイルから作る
     -tex, -html, -prn, -txt, -p2, -gplot
     TeX, HTML, スペース区切り, タブ区切り, Plain2, GNUPLOT
  2. CSV の形式変換
     -csv1, -csv2, -k3
     CSV1, CSV2, K3(桐) 形式の説明はスクリプトの末尾に
 【実行例】
   ・csv2 -tex datafile
   ・cat datafile | csv2html > data.html
 【入力】任意の漢字コード，改行形式，CSV 形式の CSV ファイル
 【出力】EUCで，動作させるＯＳネイティヴの改行形式を使った出力( 標準出力)
 【使用法】
 【オプション】
 ・動作
   -info  : 行数，カラム数の出力のみを行う
 ・変換先の形式指定: どれか一つしか指定できない(当たり前だけど)
   -tex   : TeX (の tabular 環境の)形式に変換して出力する
   -html  : HTML (の TABLE)形式に変換して出力する
   -prn   : スペース区切り形式に変換して出力する(デフォルト)
    (Excel 上で，スペース区切りのファイルにつく拡張子が prn だったので)
   -txt   : タブ区切り形式に変換して出力する
    (Excel 上で，スペース区切りのファイルにつく拡張子が txt だったので)
   -p2    : plain2 形式に変換して出力する
   -gplot : gnuplot 形式に変換して出力する
   -csv1  : csv1 形式に変換して出力する(詳細はスクリプトの末尾に)
   -csv2  : csv2 形式に変換して出力する(詳細はスクリプトの末尾に)
   -k3    : k3 形式に変換して出力する(詳細はスクリプトの末尾に)
 ・以降は -tex ～ -gplot でのみ有効なオプション
 ・寄せに関して
   -strright : 文字列を右寄せする
   -strleft  : 文字列を左寄せする(デフォルト)
   -strcent  : 文字列をセンタリングする
 ・文字に関して
   -nospc       : 余分な空白を出力しない
    (レイアウトはぐちゃぐちゃになる)
   -ifnone      : 何もないセルをここで指定した文字列で埋める
    (指定がなければスクリプト内部で指定されている文字が挿入され る)
   -ifnl        : -ifnone で指定した文字列を左寄せする(デフォル トは右寄せ)
 ・数値の丸めについてのオプション
   -doround     : これを指定した時，丸めを行う
   -round       : 丸めの結果が小数点以下何桁までにするか(デフォ ルトは1)
   -roundmethod : 丸めの方法(=1は切捨て，=2は四捨五入，=3は切上 げ)
 ・抽出
   -lfrom : この行からのデータだけ扱う
    (指定がない(=0)時は最初の行)
   -lto   : この行までのデータだけ扱う
    (指定がない(=0)時は最後の行)
   -cfrom : このカラムからのデータだけ扱う
    (指定がない(=0)時は最初のカラム)
   -cto   : このカラムまでのデータだけ扱う
    (指定がない(=0)時は最後のカラム)
   -swap  : 行と列を入れ替える
 ・番号などの追加
   -addlineno : 行番号を追加する
   -addclmnno : カラム番号を追加する
   -newlineno : -addlineno 指定時に行番号をこの番号で始める
   -newclmnno : -addclmnno 指定時にカラム番号をこの番号で始める
   -newclmndt : -addclmnno 指定時に第一行目をこの CSV リストを追加する
   -nolinenosep : -addlineno 指定時に行番号のカラムの右に
    特別なセパレータを入れない(plain2)
   -noclmnnosep : -addclmnno 指定時にカラム番号の行の下に
    特別なセパレータを入れない(plain2)
 ・平均値などの追加
   -addnum : 最終行に各カラムのデータ数を追加する
    (addlineno は自動的にオンになる)
   -addave : 最終行に各カラムの平均値を追加する
    (addlineno は自動的にオンになる)
   -addvar : 最終行に各カラムの分散を追加する
    (addlineno は自動的にオンになる)
   -addsum : 最終行に各カラムの合計値を追加する
    (addlineno は自動的にオンになる)
   -addmax : 最終行に各カラムの最大値を追加する
    (addlineno は自動的にオンになる)
   -addmin : 最終行に各カラムの最小値を追加する
    (addlineno は自動的にオンになる)
   -addsqsum : 最終行に各カラムの２乗和を追加する
    (addlineno は自動的にオンになる)
   -addstddev : 最終行に各カラムの標準偏差を追加する
    (addlineno は自動的にオンになる)
   -assumezero : 平均値などの算出時に数字と認識できないカラムは
    数字0として件数にカウント，計算に利用する
 【必要なもの】perl(version 4 以降), cpan install Jcode.pm
 【注意】
   ・デフォルトでは文字列は左寄せ，数値は右寄せ
   ・デフォルトでは空セルの場合は右寄せで指定された文字を出力
   ・デフォルトでは csv2prn として動く
   ・csv2tex なんて長い名前で面倒だという場合は csv2tex としてもＯＫ
     内部では，「2tex」の部分で判別している
 【インストール】
   ・このファイルを csv2 としてパスの通っているところに保存
   ・このファイルに csv2tex などの名前でシンボリックリンクを張ると
     csv2 -tex と同等のことができるようになる
 【もともとの場所】
   https://web.archive.org/web/19990224123351/http://www.lab1.kuis.kyoto-u.ac.jp/~matchan/archives.html
</pre>
